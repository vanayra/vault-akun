<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Password Vault</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#0f172a;
    color:white;
    margin:0;
}

.container{
    max-width:800px;
    margin:auto;
    padding:20px;
}

.card{
    background:#1e293b;
    padding:15px;
    margin-top:15px;
    border-radius:12px;
}

input, select{
    width:100%;
    padding:10px;
    margin-top:8px;
    border-radius:8px;
    border:none;
}

button{
    margin-top:10px;
    padding:10px;
    border:none;
    border-radius:8px;
    background:#3b82f6;
    color:white;
    cursor:pointer;
}

button:hover{
    background:#2563eb;
}

.hidden{
    display:none;
}

.account{
    background:#334155;
    padding:10px;
    border-radius:10px;
    margin-top:10px;
}
</style>
</head>

<body>

<div class="container">

<!-- LOGIN -->
<div id="loginCard" class="card">
<h2>üîê Master Password</h2>
<input type="password" id="masterInput" placeholder="Masukkan Password">
<button onclick="login()">Masuk</button>
</div>

<!-- MAIN -->
<div id="mainApp" class="hidden">

<h2>Password Vault</h2>

<input type="text" id="searchInput" placeholder="Search akun..." onkeyup="renderAccounts()">

<div class="card">
<h3>Tambah Akun</h3>

<input id="site" placeholder="Nama Website / Aplikasi">
<input id="username" placeholder="Username / Email">
<input id="password" placeholder="Password">

<select id="category">
<option>Social Media</option>
<option>Bank</option>
<option>Work</option>
<option>Gaming</option>
<option>Other</option>
</select>

<button onclick="addAccount()">Tambah</button>
</div>

<div class="card">
<h3>Backup Data</h3>
<button onclick="exportData()">Export</button>
<input type="file" id="importFile" onchange="importData()" />
</div>

<div id="accountList"></div>

</div>

</div>

<script>

let masterPassword="";
let accounts=[];

function encrypt(text){
    return btoa(masterPassword + text);
}

function decrypt(text){
    let decoded = atob(text);
    return decoded.replace(masterPassword,"");
}

function login(){

    let input=document.getElementById("masterInput").value;

    if(!localStorage.getItem("master")){
        localStorage.setItem("master", encrypt(input));
        masterPassword=input;
        openApp();
        return;
    }

    let saved=decrypt(localStorage.getItem("master"));

    if(saved===input){
        masterPassword=input;
        openApp();
    }else{
        alert("Password salah");
    }
}

function openApp(){
    document.getElementById("loginCard").classList.add("hidden");
    document.getElementById("mainApp").classList.remove("hidden");
    loadAccounts();
}

function addAccount(){

    let data={
        site:encrypt(document.getElementById("site").value),
        username:encrypt(document.getElementById("username").value),
        password:encrypt(document.getElementById("password").value),
        category:encrypt(document.getElementById("category").value)
    };

    accounts.push(data);
    saveAccounts();
    renderAccounts();
}

function saveAccounts(){
    localStorage.setItem("accounts", JSON.stringify(accounts));
}

function loadAccounts(){
    let data=localStorage.getItem("accounts");
    if(data){
        accounts=JSON.parse(data);
    }
    renderAccounts();
}

function togglePassword(id){
    let el=document.getElementById(id);
    el.type= el.type==="password" ? "text":"password";
}

function renderAccounts(){

    let list=document.getElementById("accountList");
    let search=document.getElementById("searchInput").value.toLowerCase();

    list.innerHTML="";

    accounts.forEach((acc,i)=>{

        let site=decrypt(acc.site);
        let user=decrypt(acc.username);
        let pass=decrypt(acc.password);
        let cat=decrypt(acc.category);

        if(site.toLowerCase().includes(search) || user.toLowerCase().includes(search)){

            list.innerHTML+=`
            <div class="account">
                <b>${site}</b> (${cat})<br>
                ${user}<br>
                <input type="password" id="pass${i}" value="${pass}" readonly>
                <button onclick="togglePassword('pass${i}')">üëÅ</button>
            </div>`;
        }

    });
}

function exportData(){

    let blob=new Blob([JSON.stringify(accounts)],{type:"application/json"});
    let a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="backup_accounts.json";
    a.click();
}

function importData(){

    let file=document.getElementById("importFile").files[0];
    let reader=new FileReader();

    reader.onload=function(e){

        try{
            accounts=JSON.parse(e.target.result);
            saveAccounts();
            renderAccounts();
            alert("Import berhasil");
        }catch{
            alert("File tidak valid");
        }

    };

    reader.readAsText(file);
}

</script>

</body>
</html>
